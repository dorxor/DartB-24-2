# 6주차
## 목표: 틀린 코드를 해석하고, 바른 코드로 고칠 수 있다.

## 문제 풀이 1
https://school.programmers.co.kr/learn/courses/30/lessons/131123\
`REST_INFO` 테이블에서 음식종류별로 즐겨찾기수가 가장 많은 식당의 음식 종류, ID, 식당 이름, 즐겨찾기수를 조회하는 SQL문을 작성해주세요. 이때 결과는 음식 종류를 기준으로 내림차순 정렬해주세요.


1. 틀린 코드 이유 분석(정답 코드 참고)

    ```sql
    # 틀린 코드
    SELECT *
    FROM (SELECT FOOD_TYPE, REST_ID, REST_NAME, MAX(FAVORITES) AS FAVORITES
    FROM REST_INFO
    GROUP BY FOOD_TYPE
    ORDER BY FOOD_TYPE DESC
    ```

    🌱 이 코드가 틀린 이유를 찾아내고, 정답 코드와 비교해 정리해주세요.
    
    ```sql
    # 정답 코드
    SELECT FOOD_TYPE, REST_ID, REST_NAME, FAVORITES
    FROM REST_INFO
    WHERE (FOOD_TYPE, FAVORITES) IN (
        SELECT FOOD_TYPE, MAX(FAVORITES)    
        FROM REST_INFO
        GROUP BY FOOD_TYPE
    ) 
    ORDER BY FOOD_TYPE DESC;
    ```
    🅰️ 답안 

2. **ROW_NUMBER 윈도우 함수**를 사용하여 개선된 쿼리 학습
    
    ```sql
    WITH RankedRest AS (
        SELECT 
            FOOD_TYPE, REST_ID, REST_NAME, FAVORITES,
            ROW_NUMBER() OVER (PARTITION BY FOOD_TYPE ORDER BY FAVORITES DESC, REST_ID) AS rnk
        FROM REST_INFO
    )
    SELECT 
        FOOD_TYPE, REST_ID, REST_NAME, FAVORITES
    FROM RankedRest
    WHERE rnk = 1
    ORDER BY FOOD_TYPE DESC;
    ```
    🌱 이 코드를 단계별로 해석하고(주석 사용 등), 위 코드에 비해 갖는 이점을 설명하세요.

    🅰️ 답안 

## 문제 풀이 2
https://school.programmers.co.kr/learn/courses/30/lessons/284527


```sql
# 기본 코드
SELECT 
    EMP_NO, 
    EMP_NAME, 
    SAL,
    RANK() OVER (ORDER BY SAL DESC) AS rnk
FROM 
    HR_EMPLOYEES;
```

🌱 **RANK(), DENSE_RANK(), ROW_NUMBER() 함수**를 사용하며 결과를 비교하고 해당 함수를 사용하는 경우를 서술해주세요. 


- (함수 사용 예제는 직접 찾아보기)